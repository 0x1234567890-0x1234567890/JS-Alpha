<style>
#_plain{
    width:100%;
    height:100%;
}
#_code{
    width:100%;
    height:100%
}
#_convert{
    position: absolute;
    top:5px;
    right:5px;
    opacity:0.6;
    cursor: pointer;
}

#_eval{
    position: absolute;
    top:30px;
    right:5px;
    opacity:0.6;
    cursor: pointer;
}

table{
    width:100%;
    height:800px;
}

table td{
    position: relative;
}

</style>
<h1>/[a-z.()]+/ Convertor</h1>
<table>
    <tr>
        <td>
            <textarea id=_plain>alert('xss')</textarea>
            <button id=_convert>convert</button>
            <button id=_eval>eval</button>
        </td>
        <td>
            <textarea id=_code></textarea>
        </td>
    </tr>
</table>





<script>
const emptystr = 'escape().match().pop()';
const dict = {
    0: 'escape().sub.length',
    1: 'eval.length',
    2: 'escape().replace.length',
    3: 'escape().sub.name.length',
    4: 'eval.name.length',
    5: 'escape(false).length',
    6: 'escape.name.length',
    7: '(typeof(true)).length',
    8: 'unescape.name.length',
    9: 'escape().length',
    a: 'eval.apply.name.split(escape().constructor()).shift()',
    b: 'eval.bind.name.split(escape().constructor()).shift()',
    c: 'eval.call.name.split(escape().constructor()).shift()',
    d: 'eval.bind.name.split(escape().constructor()).pop()',
    e: 'eval.name.split(escape().constructor()).shift()',
    f: 'escape(eval).split(escape().constructor()).shift()',
    ')': 'unescape(eval).slice(...escape().match().pop().concat(escape().concat(false).length).concat(eval).concat(eval.name.sup().length).split(eval))',
    '%': 'escape(crypto).split(escape().match().pop()).shift()',
    27: 'escape().sup().bold().length',
}

dict['\''] = `unescape(${dict['%']}.concat(${dict[27]}))`
const join = `unescape(${dict['%']}.concat(${dict[5]}).concat(${dict['c']}))` // \
console.log(join);



function intToStr(i){
    let x = i.toString()
    let res = emptystr;
    for(let c of x) res+= `.concat(${dict[c]})`
    return res
}

function toCode(code){
    let prefix = `unescape(eval).substr(...(escape(escape().length).concat(eval).concat(${dict[5]}).split(eval))).concat(${dict['\'']})`
    let mid = 'escape().match()'
    for(let c of code) {
        let oct = c.charCodeAt(0).toString(8);
        mid += `.concat(${intToStr(oct)})`
    }
    mid += `.join(${join})`
    let suf = `${dict['\'']}).concat(${dict[')']}`

    return `eval(${prefix}.concat(${mid}).concat(${suf}))`
}

_convert.onclick = function(){
    let code = _plain.value;
    let res = toCode(code);
    _code.value = res
}

_eval.onclick = function(){
    _convert.click();
    let code = _code.value;
    eval(code);
}

</script>
